<!DOCTYPE html>
<html lang="zh-Hant">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>聲樂課報名訊息產生器</title>
	<style>
		:root {
			color-scheme: light;
			font-family: "Noto Sans TC", "Microsoft JhengHei", system-ui, -apple-system, sans-serif;
		}

		body {
			margin: 0;
			background: #f6f7fb;
			color: #222;
			display: flex;
			align-items: center;
			justify-content: center;
			min-height: 100vh;
		}

		.card {
			width: min(720px, 92vw);
			background: #fff;
			border: 1px solid #e3e6ee;
			border-radius: 16px;
			box-shadow: 0 10px 30px rgba(0, 0, 0, 0.06);
			padding: 28px;
		}

		h1 {
			margin: 0 0 18px;
			font-size: 22px;
			letter-spacing: 0.2px;
			color: #1a1f36;
		}

		.grid {
			/* display: grid;
			grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); */
			gap: 14px 18px;
			margin-bottom: 18px;
		}

		label {
			display: flex;
			flex-direction: column;
			gap: 6px;
			font-weight: 600;
			font-size: 14px;
			color: #2c3144;
		}

		input, select, textarea {
			font: inherit;
			border: 1px solid #d5d9e5;
			border-radius: 10px;
			padding: 10px 12px;
			transition: border-color 0.2s, box-shadow 0.2s;
		}

		input:focus, select:focus, textarea:focus {
			outline: none;
			border-color: #4f8bff;
			box-shadow: 0 0 0 3px rgba(79, 139, 255, 0.2);
		}

		.actions {
			display: flex;
			gap: 12px;
			align-items: center;
			margin: 6px 0 16px;
		}

		button {
			font: inherit;
			border: none;
			border-radius: 10px;
			padding: 10px 16px;
			cursor: pointer;
			transition: transform 0.1s ease, box-shadow 0.2s ease;
		}

		.primary {
			background: #4f8bff;
			color: #fff;
			box-shadow: 0 8px 18px rgba(79, 139, 255, 0.25);
		}

		.ghost {
			background: #f1f4fb;
			color: #1a1f36;
			border: 1px solid #dbe2f4;
		}

		button:active {
			transform: translateY(1px);
		}

		.result {
			border: 1px solid #dfe3ed;
			background: #fafbff;
			border-radius: 12px;
			padding: 14px 16px;
			min-height: 140px;
			white-space: pre-wrap;
			line-height: 1.6;
			color: #1d2236;
		}

		.hidden {
			display: none;
		}

		.muted {
			color: #6c7591;
			font-size: 13px;
		}

		.status {
			font-size: 13px;
			color: #22863a;
			opacity: 0;
			transition: opacity 0.2s;
		}

		.status.show {
			opacity: 1;
		}

		.history-title {
			margin: 18px 0 8px;
			font-size: 13px;
			color: #6c7591;
		}

		.history-list {
			display: flex;
			flex-direction: column;
			gap: 10px;
			m-height: 320px;
			overflow-y: auto;
			padding-right: 4px;
		}

		.history-item {
			border: 1px solid #e7eaf3;
			background: #ffffff;
			border-radius: 10px;
			padding: 10px 12px;
			white-space: pre-wrap;
			line-height: 1.5;
			color: #1f2438;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.04);
		}

		.history-actions {
			display: flex;
			gap: 8px;
			align-items: center;
			margin-top: 8px;
		}

		.history-btn {
			padding: 8px 12px;
			border-radius: 8px;
			border: 1px solid #dbe2f4;
			background: #f6f8fd;
			color: #1a1f36;
			font-size: 14px;
		}

		.history-btn.primary {
			background: #4f8bff;
			color: #fff;
			border-color: #4f8bff;
			box-shadow: 0 6px 14px rgba(79, 139, 255, 0.22);
		}

		.history-status {
			font-size: 12px;
			color: #22863a;
			opacity: 0;
			transition: opacity 0.2s;
		}

		.history-status.show {
			opacity: 1;
		}

		.history-editor {
			margin-top: 6px;
			width: 100%;
			box-sizing: border-box;
			font: inherit;
			border: 1px solid #d5d9e5;
			border-radius: 8px;
			padding: 10px 12px;
			line-height: 1.5;
			min-height: 120px;
		}
	</style>
</head>
<body>
	<main class="card" aria-live="polite">
		<h1>聲樂課報名訊息產生器</h1>
		<section class="grid" aria-label="輸入區">
			<label>日期
				<input type="date" id="date" required>
			</label>
			<label>時間
				<input type="text" id="time" placeholder="例如：14:00-15:00" required>
			</label>
			<label>報名人
				<input type="text" id="name" placeholder="請輸入姓名" required>
			</label>
			<label>地點
				<select id="location" required>
					<option value="">請選擇</option>
					<option value="807">807</option>
					<option value="128">128</option>
					<option value="藝心坊">藝心坊</option>
				</select>
			</label>
		</section>

		<div class="actions">
			<button class="primary" id="generate">產生訊息</button>
		</div>

		<div class="muted">結果：</div>
		<div class="result" id="result" role="status"></div>

		<div class="history-title">歷史紀錄</div>
		<div class="history-list" id="historyList" aria-label="歷史紀錄"></div>
	</main>

	<script>
		const dateInput = document.getElementById('date');
		const timeInput = document.getElementById('time');
		const nameInput = document.getElementById('name');
		const locationSelect = document.getElementById('location');
		const resultDiv = document.getElementById('result');
		const historyList = document.getElementById('historyList');
		const generateBtn = document.getElementById('generate');

		const template = ({ date, time, name, location }) => (
			`恭喜您已成功報名聲樂課！\n` +
			`時間：${date} ${time}\n` +
			`報名人：${name}\n` +
			`地點：${location}\n` +
			`上課前請務必先詳閱此附件，並請記得攜帶領據（領據於課後請老師簽名，並將指導費用信封袋裝好交給老師）、譜、指導費、筆、水！\n` +
			`第一個上課的記得借教室和冷氣！`
		);

		function formatDate(value) {
			if (!value) return '';
			const date = new Date(value);
			if (Number.isNaN(date.getTime())) return value;
			return date.toLocaleDateString('zh-TW', { year: 'numeric', month: '2-digit', day: '2-digit' });
		}

		function updateResult(text) {
			resultDiv.textContent = text;
		}

		function createHistoryItem(text) {
			if (!text.trim()) return;
			const item = document.createElement('div');
			item.className = 'history-item';

			const content = document.createElement('div');
			content.textContent = text;

			const editor = document.createElement('textarea');
			editor.className = 'history-editor hidden';
			editor.value = text;

			const actions = document.createElement('div');
			actions.className = 'history-actions';

			const copyBtn = document.createElement('button');
			copyBtn.className = 'history-btn';
			copyBtn.type = 'button';
			copyBtn.textContent = '複製';

			const editBtn = document.createElement('button');
			editBtn.className = 'history-btn primary';
			editBtn.type = 'button';
			editBtn.textContent = '編輯';

			const status = document.createElement('span');
			status.className = 'history-status';
			status.textContent = '已複製';

			function showStatus() {
				status.classList.add('show');
				setTimeout(() => status.classList.remove('show'), 1200);
			}

			async function handleCopy() {
				const textToCopy = editor.classList.contains('hidden') ? content.textContent : editor.value;
				if (!textToCopy.trim()) return;
				try {
					await navigator.clipboard.writeText(textToCopy);
					showStatus();
				} catch (err) {
					alert('複製失敗，請手動複製。');
					console.error(err);
				}
			}

			function toggleEdit() {
				const editing = editor.classList.contains('hidden');
				if (editing) {
					editor.classList.remove('hidden');
					content.classList.add('hidden');
					editBtn.textContent = '完成';
					editor.focus();
					editor.setSelectionRange(editor.value.length, editor.value.length);
				} else {
					content.textContent = editor.value.trim();
					editor.classList.add('hidden');
					content.classList.remove('hidden');
					editBtn.textContent = '編輯';
				}
			}

			copyBtn.addEventListener('click', handleCopy);
			editBtn.addEventListener('click', toggleEdit);

			actions.append(copyBtn, editBtn, status);
			item.append(content, editor, actions);
			historyList.appendChild(item);
		}

		generateBtn.addEventListener('click', () => {
			if (!dateInput.reportValidity() || !timeInput.reportValidity() || !nameInput.reportValidity() || !locationSelect.reportValidity()) {
				return;
			}
			const message = template({
				date: formatDate(dateInput.value),
				time: timeInput.value.trim(),
				name: nameInput.value.trim(),
				location: locationSelect.value,
			});
			updateResult(message);
			createHistoryItem(message);
		});
	</script>
</body>
</html>
